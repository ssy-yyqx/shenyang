/**
 * Cesium - https://github.com/AnalyticalGraphicsInc/cesium
 *
 * Copyright 2011-2020 Cesium Contributors
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * Columbus View (Pat. Pend.)
 *
 * Portions licensed separately.
 * See https://github.com/AnalyticalGraphicsInc/cesium/blob/master/LICENSE.md for full licensing details.
 */
define(["./when-4ca4e419","./Check-430b3551","./Math-c0afb7aa","./Cartesian2-0cd32dae","./defineProperties-24e785e9","./Transforms-1f147cce","./RuntimeError-443472b0","./WebGLConstants-2ddfa2f9","./ComponentDatatype-adb4702b","./GeometryAttribute-ebf6a4c7","./EncodedCartesian3-17533efe","./IntersectionTests-9618f995","./Plane-6d029ea4","./WebMercatorProjection-3d1fffe8","./arrayRemoveDuplicates-0e267e0f","./ArcType-51c149e1","./EllipsoidRhumbLine-aeb03c9a","./EllipsoidGeodesic-f0d5153e"],function(B,e,Oe,Pe,a,be,t,n,ke,Ae,Le,G,r,i,V,j,Y,M){"use strict";function s(e){e=B.defaultValue(e,B.defaultValue.EMPTY_OBJECT),this._ellipsoid=B.defaultValue(e.ellipsoid,Pe.Ellipsoid.WGS84),this._rectangle=B.defaultValue(e.rectangle,Pe.Rectangle.MAX_VALUE),this._projection=new be.GeographicProjection(this._ellipsoid),this._numberOfLevelZeroTilesX=B.defaultValue(e.numberOfLevelZeroTilesX,2),this._numberOfLevelZeroTilesY=B.defaultValue(e.numberOfLevelZeroTilesY,1)}a.defineProperties(s.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},rectangle:{get:function(){return this._rectangle}},projection:{get:function(){return this._projection}}}),s.prototype.getNumberOfXTilesAtLevel=function(e){return this._numberOfLevelZeroTilesX<<e},s.prototype.getNumberOfYTilesAtLevel=function(e){return this._numberOfLevelZeroTilesY<<e},s.prototype.rectangleToNativeRectangle=function(e,a){var t=Oe.CesiumMath.toDegrees(e.west),n=Oe.CesiumMath.toDegrees(e.south),i=Oe.CesiumMath.toDegrees(e.east),e=Oe.CesiumMath.toDegrees(e.north);return B.defined(a)?(a.west=t,a.south=n,a.east=i,a.north=e,a):new Pe.Rectangle(t,n,i,e)},s.prototype.tileXYToNativeRectangle=function(e,a,t,n){n=this.tileXYToRectangle(e,a,t,n);return n.west=Oe.CesiumMath.toDegrees(n.west),n.south=Oe.CesiumMath.toDegrees(n.south),n.east=Oe.CesiumMath.toDegrees(n.east),n.north=Oe.CesiumMath.toDegrees(n.north),n},s.prototype.tileXYToRectangle=function(e,a,t,n){var i=this._rectangle,r=this.getNumberOfXTilesAtLevel(t),s=this.getNumberOfYTilesAtLevel(t),t=i.width/r,r=e*t+i.west,e=(e+1)*t+i.west,t=i.height/s,s=i.north-a*t,t=i.north-(a+1)*t;return(n=!B.defined(n)?new Pe.Rectangle(r,t,e,s):n).west=r,n.south=t,n.east=e,n.north=s,n},s.prototype.positionToTileXY=function(e,a,t){var n=this._rectangle;if(Pe.Rectangle.contains(n,e)){var i=this.getNumberOfXTilesAtLevel(a),r=this.getNumberOfYTilesAtLevel(a),s=n.width/i,o=n.height/r,a=e.longitude;n.east<n.west&&(a+=Oe.CesiumMath.TWO_PI);s=(a-n.west)/s|0;i<=s&&(s=i-1);o=(n.north-e.latitude)/o|0;return(r<=o&&(o=r-1),B.defined(t))?(t.x=s,t.y=o,t):new Pe.Cartesian2(s,o)}};var o=new Pe.Cartesian3,l=new Pe.Cartesian3,u=new Pe.Cartographic,c=new Pe.Cartesian3,C=new Pe.Cartesian3,p=new be.BoundingSphere,d=new s,h=[new Pe.Cartographic,new Pe.Cartographic,new Pe.Cartographic,new Pe.Cartographic],g=new Pe.Cartesian2,Se={};function f(e){Pe.Cartographic.fromRadians(e.east,e.north,0,h[0]),Pe.Cartographic.fromRadians(e.west,e.north,0,h[1]),Pe.Cartographic.fromRadians(e.east,e.south,0,h[2]),Pe.Cartographic.fromRadians(e.west,e.south,0,h[3]);for(var a=0,t=0,n=0,i=0,r=Se._terrainHeightsMaxLevel,s=0;s<=r;++s){for(var o=!1,l=0;l<4;++l){var u=h[l];if(d.positionToTileXY(u,s,g),0===l)n=g.x,i=g.y;else if(n!==g.x||i!==g.y){o=!0;break}}if(o)break;a=n,t=i}if(0!==s)return{x:a,y:t,level:r<s?r:s-1}}Se.initialize=function(){var e=Se._initPromise;return B.defined(e)?e:(e=be.Resource.fetchJson(be.buildModuleUrl("Assets/approximateTerrainHeights.json")).then(function(e){Se._terrainHeights=e}),Se._initPromise=e)},Se.getMinimumMaximumHeights=function(e,a){a=B.defaultValue(a,Pe.Ellipsoid.WGS84);var t=f(e),n=Se._defaultMinTerrainHeight,i=Se._defaultMaxTerrainHeight;return B.defined(t)&&(t=t.level+"-"+t.x+"-"+t.y,t=Se._terrainHeights[t],B.defined(t)&&(n=t[0],i=t[1]),a.cartographicToCartesian(Pe.Rectangle.northeast(e,u),o),a.cartographicToCartesian(Pe.Rectangle.southwest(e,u),l),Pe.Cartesian3.midpoint(l,o,c),a=a.scaleToGeodeticSurface(c,C),n=B.defined(a)?(a=Pe.Cartesian3.distance(c,a),Math.min(n,-a)):Se._defaultMinTerrainHeight),{minimumTerrainHeight:n=Math.max(Se._defaultMinTerrainHeight,n),maximumTerrainHeight:i}},Se.getBoundingSphere=function(e,a){a=B.defaultValue(a,Pe.Ellipsoid.WGS84);var t=f(e),n=Se._defaultMaxTerrainHeight;B.defined(t)&&(i=t.level+"-"+t.x+"-"+t.y,i=Se._terrainHeights[i],B.defined(i)&&(n=i[1]));var i=be.BoundingSphere.fromRectangle3D(e,a,0);return be.BoundingSphere.fromRectangle3D(e,a,n,p),be.BoundingSphere.union(i,p,i)},Se._terrainHeightsMaxLevel=6,Se._defaultMaxTerrainHeight=9e3,Se._defaultMinTerrainHeight=-1e5,Se._terrainHeights=void 0,Se._initPromise=void 0,a.defineProperties(Se,{initialized:{get:function(){return B.defined(Se._terrainHeights)}}});var F=[be.GeographicProjection,i.WebMercatorProjection],m=F.length,Ie=Math.cos(Oe.CesiumMath.toRadians(30)),w=Math.cos(Oe.CesiumMath.toRadians(150)),q=0,X=1e3;function y(e){var a=(e=B.defaultValue(e,B.defaultValue.EMPTY_OBJECT)).positions;this.width=B.defaultValue(e.width,1),this._positions=a,this.granularity=B.defaultValue(e.granularity,9999),this.loop=B.defaultValue(e.loop,!1),this.arcType=B.defaultValue(e.arcType,j.ArcType.GEODESIC),this._ellipsoid=Pe.Ellipsoid.WGS84,this._projectionIndex=0,this._workerName="createGroundPolylineGeometry",this._scene3DOnly=!1}a.defineProperties(y.prototype,{packedLength:{get:function(){return 1+3*this._positions.length+1+1+1+Pe.Ellipsoid.packedLength+1+1}}}),y.setProjectionAndEllipsoid=function(e,a){for(var t=0,n=0;n<m;n++)if(a instanceof F[n]){t=n;break}e._projectionIndex=t,e._ellipsoid=a.ellipsoid};var v=new Pe.Cartesian3,T=new Pe.Cartesian3,E=new Pe.Cartesian3;function W(e,a,t,n,i){var r=Z(n,e,0,v),t=Z(n,e,t,T),a=Z(n,a,0,E),t=xe(t,r,T),r=xe(a,r,E);return Pe.Cartesian3.cross(r,t,i),Pe.Cartesian3.normalize(i,i)}var _=new Pe.Cartographic,O=new Pe.Cartesian3,P=new Pe.Cartesian3,b=new Pe.Cartesian3;function U(e,a,t,n,i,r,s,o,l,u,c){if(0!==i){var C;r===j.ArcType.GEODESIC?C=new M.EllipsoidGeodesic(e,a,s):r===j.ArcType.RHUMB&&(C=new Y.EllipsoidRhumbLine(e,a,s));r=C.surfaceDistance;if(!(r<i))for(var p=W(e,a,n,s,b),i=Math.ceil(r/i),d=r/i,h=d,g=i-1,f=o.length,m=0;m<g;m++){var w=C.interpolateUsingSurfaceDistance(h,_),y=Z(s,w,t,O),v=Z(s,w,n,P);Pe.Cartesian3.pack(p,o,f),Pe.Cartesian3.pack(y,l,f),Pe.Cartesian3.pack(v,u,f),c.push(w.latitude),c.push(w.longitude),f+=3,h+=d}}}var k=new Pe.Cartographic;function Z(e,a,t,n){return Pe.Cartographic.clone(a,k),k.height=t,Pe.Cartographic.toCartesian(k,e,n)}function xe(e,a,t){return Pe.Cartesian3.subtract(e,a,t),Pe.Cartesian3.normalize(t,t),t}function A(e,a,t,n){return n=xe(e,a,n),n=Pe.Cartesian3.cross(n,t,n),n=Pe.Cartesian3.normalize(n,n),n=Pe.Cartesian3.cross(t,n,n)}y.pack=function(e,a,t){var n=B.defaultValue(t,0),i=e._positions,r=i.length;a[n++]=r;for(var s=0;s<r;++s){var o=i[s];Pe.Cartesian3.pack(o,a,n),n+=3}return a[n++]=e.granularity,a[n++]=e.loop?1:0,a[n++]=e.arcType,Pe.Ellipsoid.pack(e._ellipsoid,a,n),n+=Pe.Ellipsoid.packedLength,a[n++]=e._projectionIndex,a[n++]=e._scene3DOnly?1:0,a},y.unpack=function(e,a,t){for(var n=B.defaultValue(a,0),i=e[n++],r=new Array(i),s=0;s<i;s++)r[s]=Pe.Cartesian3.unpack(e,n),n+=3;var o=e[n++],l=1===e[n++],u=e[n++],c=Pe.Ellipsoid.unpack(e,n);n+=Pe.Ellipsoid.packedLength;var C=e[n++],a=1===e[n++];return(t=!B.defined(t)?new y({positions:r}):t)._positions=r,t.granularity=o,t.loop=l,t.arcType=u,t._ellipsoid=c,t._projectionIndex=C,t._scene3DOnly=a,t};var L=new Pe.Cartesian3,S=new Pe.Cartesian3,I=new Pe.Cartesian3,x=new Pe.Cartesian3;function J(e,a,t,n,i){t=xe(t,a,x),e=A(e,a,t,L),a=A(n,a,t,S);if(Oe.CesiumMath.equalsEpsilon(Pe.Cartesian3.dot(e,a),-1,Oe.CesiumMath.EPSILON5))return i=Pe.Cartesian3.cross(t,e,i),i=Pe.Cartesian3.normalize(i,i);i=Pe.Cartesian3.add(a,e,i),i=Pe.Cartesian3.normalize(i,i);t=Pe.Cartesian3.cross(t,i,I);return i=Pe.Cartesian3.dot(a,t)<0?Pe.Cartesian3.negate(i,i):i}var Q=r.Plane.fromPointNormal(Pe.Cartesian3.ZERO,Pe.Cartesian3.UNIT_Y),K=new Pe.Cartesian3,$=new Pe.Cartesian3,ee=new Pe.Cartesian3,ae=new Pe.Cartesian3,te=new Pe.Cartesian3,ne=new Pe.Cartesian3,ie=new Pe.Cartographic,re=new Pe.Cartographic,se=new Pe.Cartographic;y.createGeometry=function(e){var a,t,n,i,r,s=!e._scene3DOnly,o=e.loop,l=e._ellipsoid,u=e.granularity,c=e.arcType,C=new F[e._projectionIndex](l),p=q,d=X,h=e._positions,g=h.length;2===g&&(o=!1);for(var f,m,w,y=new Y.EllipsoidRhumbLine(void 0,void 0,l),v=[h[0]],M=0;M<g-1;M++)t=h[M],n=h[M+1],f=G.IntersectionTests.lineSegmentPlane(t,n,Q,ne),!B.defined(f)||Pe.Cartesian3.equalsEpsilon(f,t,Oe.CesiumMath.EPSILON7)||Pe.Cartesian3.equalsEpsilon(f,n,Oe.CesiumMath.EPSILON7)||(e.arcType===j.ArcType.GEODESIC?v.push(Pe.Cartesian3.clone(f)):e.arcType===j.ArcType.RHUMB&&(w=l.cartesianToCartographic(f,ie).longitude,i=l.cartesianToCartographic(t,ie),r=l.cartesianToCartographic(n,re),y.setEndPoints(i,r),m=y.findIntersectionWithLongitude(w,se),f=l.cartographicToCartesian(m,ne),!B.defined(f)||Pe.Cartesian3.equalsEpsilon(f,t,Oe.CesiumMath.EPSILON7)||Pe.Cartesian3.equalsEpsilon(f,n,Oe.CesiumMath.EPSILON7)||v.push(Pe.Cartesian3.clone(f)))),v.push(n);o&&(t=h[g-1],n=h[0],f=G.IntersectionTests.lineSegmentPlane(t,n,Q,ne),!B.defined(f)||Pe.Cartesian3.equalsEpsilon(f,t,Oe.CesiumMath.EPSILON7)||Pe.Cartesian3.equalsEpsilon(f,n,Oe.CesiumMath.EPSILON7)||(e.arcType===j.ArcType.GEODESIC?v.push(Pe.Cartesian3.clone(f)):e.arcType===j.ArcType.RHUMB&&(w=l.cartesianToCartographic(f,ie).longitude,i=l.cartesianToCartographic(t,ie),r=l.cartesianToCartographic(n,re),y.setEndPoints(i,r),m=y.findIntersectionWithLongitude(w,se),f=l.cartographicToCartesian(m,ne),!B.defined(f)||Pe.Cartesian3.equalsEpsilon(f,t,Oe.CesiumMath.EPSILON7)||Pe.Cartesian3.equalsEpsilon(f,n,Oe.CesiumMath.EPSILON7)||v.push(Pe.Cartesian3.clone(f)))));var T=v.length,E=new Array(T);for(M=0;M<T;M++){var _=Pe.Cartographic.fromCartesian(v[M],l);_.height=0,E[M]=_}if(!((T=(E=V.arrayRemoveDuplicates(E,Pe.Cartographic.equalsEpsilon)).length)<2)){var O=[],P=[],b=[],k=[],A=K,L=$,S=ee,I=ae,x=te,N=E[0],R=E[1];for(A=Z(l,E[T-1],p,A),I=Z(l,R,p,I),L=Z(l,N,p,L),S=Z(l,N,d,S),x=o?J(A,L,S,I,x):W(N,R,d,l,x),Pe.Cartesian3.pack(x,P,0),Pe.Cartesian3.pack(L,b,0),Pe.Cartesian3.pack(S,k,0),O.push(N.latitude),O.push(N.longitude),U(N,R,p,d,u,c,l,P,b,k,O),M=1;M<T-1;++M){var A=Pe.Cartesian3.clone(L,A),L=Pe.Cartesian3.clone(I,L),D=E[M];Z(l,D,d,S),Z(l,E[M+1],p,I),J(A,L,S,I,x),a=P.length,Pe.Cartesian3.pack(x,P,a),Pe.Cartesian3.pack(L,b,a),Pe.Cartesian3.pack(S,k,a),O.push(D.latitude),O.push(D.longitude),U(E[M],E[M+1],p,d,u,c,l,P,b,k,O)}var z=E[T-1],H=E[T-2];if(L=Z(l,z,p,L),S=Z(l,z,d,S),x=o?(R=E[0],J(A=Z(l,H,p,A),L,S,I=Z(l,R,p,I),x)):W(H,z,d,l,x),a=P.length,Pe.Cartesian3.pack(x,P,a),Pe.Cartesian3.pack(L,b,a),Pe.Cartesian3.pack(S,k,a),O.push(z.latitude),O.push(z.longitude),o){for(U(z,N,p,d,u,c,l,P,b,k,O),a=P.length,M=0;M<3;++M)P[a+M]=P[M],b[a+M]=b[M],k[a+M]=k[M];O.push(N.latitude),O.push(N.longitude)}return function(e,a,t,n,i,r,s){var o,l,u,c,C,p,d=a._ellipsoid,h=t.length/3-1,g=8*h,f=4*g,m=36*h,w=new(65535<g?Uint32Array:Uint16Array)(m),y=new Float64Array(3*g),v=new Float32Array(f),M=new Float32Array(f),T=new Float32Array(f),E=new Float32Array(f),_=new Float32Array(f);s&&(u=new Float32Array(f),c=new Float32Array(f),C=new Float32Array(f),p=new Float32Array(2*g));var O=r.length/2,P=0,b=He;b.height=0;var k=Be;k.height=0;var A=Ge,L=Ve;if(s)for(l=0,o=1;o<O;o++)b.latitude=r[l],b.longitude=r[l+1],k.latitude=r[l+2],k.longitude=r[l+3],A=a.project(b,A),L=a.project(k,L),P+=Pe.Cartesian3.distance(A,L),l+=2;var S=n.length/3;L=Pe.Cartesian3.unpack(n,0,L);var I,x=0;for(l=3,o=1;o<S;o++)A=Pe.Cartesian3.clone(L,A),L=Pe.Cartesian3.unpack(n,l,L),x+=Pe.Cartesian3.distance(A,L),l+=3;l=3;var N=0,R=0,D=0,z=0,H=!1,B=Pe.Cartesian3.unpack(t,0,Ye),G=Pe.Cartesian3.unpack(n,0,Ve),V=Pe.Cartesian3.unpack(i,0,qe);e&&(_e=Pe.Cartesian3.unpack(t,t.length-6,je),Ne(V,_e,B,G)&&(V=Pe.Cartesian3.negate(V,V)));var j,Y,F,q,X,W,U,Z=0,J=0,Q=0;for(o=0;o<h;o++){var K=Pe.Cartesian3.clone(B,je),$=Pe.Cartesian3.clone(G,Ge),ee=Pe.Cartesian3.clone(V,Fe);H&&(ee=Pe.Cartesian3.negate(ee,ee)),B=Pe.Cartesian3.unpack(t,l,Ye),G=Pe.Cartesian3.unpack(n,l,Ve),V=Pe.Cartesian3.unpack(i,l,qe),H=Ne(V,K,B,G),b.latitude=r[N],b.longitude=r[N+1],k.latitude=r[N+2],k.longitude=r[N+3],s&&(Me=function(e,a){var t=Math.abs(e.longitude),n=Math.abs(a.longitude);{if(Oe.CesiumMath.equalsEpsilon(t,Oe.CesiumMath.PI,Oe.CesiumMath.EPSILON11)){var i=Oe.CesiumMath.sign(a.longitude);return e.longitude=i*(t-Oe.CesiumMath.EPSILON11),1}if(Oe.CesiumMath.equalsEpsilon(n,Oe.CesiumMath.PI,Oe.CesiumMath.EPSILON11)){e=Oe.CesiumMath.sign(e.longitude);return a.longitude=e*(n-Oe.CesiumMath.EPSILON11),2}}return 0}(b,k),j=a.project(b,Ke),(pe=xe(Y=a.project(k,$e),j,ca)).y=Math.abs(pe.y),F=ea,q=aa,0===Me||Pe.Cartesian3.dot(pe,Pe.Cartesian3.UNIT_Y)>Ie?(F=Re(a,b,ee,j,ea),q=Re(a,k,V,Y,aa)):1===Me?(q=Re(a,k,V,Y,aa),F.x=0,F.y=Oe.CesiumMath.sign(b.longitude-Math.abs(k.longitude)),F.z=0):(F=Re(a,b,ee,j,ea),q.x=0,q.y=Oe.CesiumMath.sign(b.longitude-k.longitude),q.z=0));var ae=Pe.Cartesian3.distance($,G),te=Le.EncodedCartesian3.fromCartesian(K,la),ne=Pe.Cartesian3.subtract(B,K,ta),ie=Pe.Cartesian3.normalize(ne,ra),re=Pe.Cartesian3.subtract($,K,na);re=Pe.Cartesian3.normalize(re,re);var se=Pe.Cartesian3.cross(ie,re,ra);se=Pe.Cartesian3.normalize(se,se);var oe=Pe.Cartesian3.cross(re,ee,sa);oe=Pe.Cartesian3.normalize(oe,oe);var le=Pe.Cartesian3.subtract(G,B,ia);le=Pe.Cartesian3.normalize(le,le);var ue=Pe.Cartesian3.cross(V,le,oa);ue=Pe.Cartesian3.normalize(ue,ue);var ce=ae/x,Ce=Z/x,pe=0,de=0,he=0;for(s&&(pe=Pe.Cartesian3.distance(j,Y),X=Le.EncodedCartesian3.fromCartesian(j,ua),W=Pe.Cartesian3.subtract(Y,j,ca),Te=(U=Pe.Cartesian3.normalize(W,Ca)).x,U.x=U.y,U.y=-Te,de=pe/P,he=J/P),I=0;I<8;I++){var ge=z+4*I,fe=R+2*I,me=ge+3,we=I<4?1:-1,ye=2===I||3===I||6===I||7===I?1:-1;Pe.Cartesian3.pack(te.high,v,ge),v[me]=ne.x,Pe.Cartesian3.pack(te.low,M,ge),M[me]=ne.y,Pe.Cartesian3.pack(oe,T,ge),T[me]=ne.z,Pe.Cartesian3.pack(ue,E,ge),E[me]=ce*we,Pe.Cartesian3.pack(se,_,ge);var ve=Ce*ye;0===ve&&ye<0&&(ve=9),_[me]=ve,s&&(u[ge]=X.high.x,u[ge+1]=X.high.y,u[ge+2]=X.low.x,u[ge+3]=X.low.y,C[ge]=-F.y,C[ge+1]=F.x,C[ge+2]=q.y,C[ge+3]=-q.x,c[ge]=W.x,c[ge+1]=W.y,c[ge+2]=U.x,c[ge+3]=U.y,p[fe]=de*we,0===(ve=he*ye)&&ye<0&&(ve=9),p[fe+1]=ve)}var Me=Je,ie=Qe,re=Ue,ee=Ze,le=Pe.Rectangle.fromCartographicArray(Xe,We),Te=Se.getMinimumMaximumHeights(le,d),le=Te.minimumTerrainHeight,Te=Te.maximumTerrainHeight;Q+=le,Q+=Te,De(K,$,le,Te,Me,re),De(B,G,le,Te,ie,ee);Te=Pe.Cartesian3.multiplyByScalar(se,Oe.CesiumMath.EPSILON5,pa);Pe.Cartesian3.add(Me,Te,Me),Pe.Cartesian3.add(ie,Te,ie),Pe.Cartesian3.add(re,Te,re),Pe.Cartesian3.add(ee,Te,ee),ze(Me,ie),ze(re,ee),Pe.Cartesian3.pack(Me,y,D),Pe.Cartesian3.pack(ie,y,D+3),Pe.Cartesian3.pack(ee,y,D+6),Pe.Cartesian3.pack(re,y,D+9),Te=Pe.Cartesian3.multiplyByScalar(se,-2*Oe.CesiumMath.EPSILON5,pa),Pe.Cartesian3.add(Me,Te,Me),Pe.Cartesian3.add(ie,Te,ie),Pe.Cartesian3.add(re,Te,re),Pe.Cartesian3.add(ee,Te,ee),ze(Me,ie),ze(re,ee),Pe.Cartesian3.pack(Me,y,D+12),Pe.Cartesian3.pack(ie,y,D+15),Pe.Cartesian3.pack(ee,y,D+18),Pe.Cartesian3.pack(re,y,D+21),N+=2,l+=3,R+=16,D+=24,z+=32,Z+=ae,J+=pe}var Ee=l=0;for(o=0;o<h;o++){for(I=0;I<ga;I++)w[l+I]=ha[I]+Ee;Ee+=8,l+=ga}e=da;be.BoundingSphere.fromVertices(t,Pe.Cartesian3.ZERO,3,e[0]),be.BoundingSphere.fromVertices(n,Pe.Cartesian3.ZERO,3,e[1]);var _e=be.BoundingSphere.fromBoundingSpheres(e);_e.radius+=Q/(2*h);e={position:new Ae.GeometryAttribute({componentDatatype:ke.ComponentDatatype.DOUBLE,componentsPerAttribute:3,normalize:!1,values:y}),startHiAndForwardOffsetX:fa(v),startLoAndForwardOffsetY:fa(M),startNormalAndForwardOffsetZ:fa(T),endNormalAndTextureCoordinateNormalizationX:fa(E),rightNormalAndTextureCoordinateNormalizationY:fa(_)};s&&(e.startHiLo2D=fa(u),e.offsetAndRight2D=fa(c),e.startEndNormals2D=fa(C),e.texcoordNormalization2D=new Ae.GeometryAttribute({componentDatatype:ke.ComponentDatatype.FLOAT,componentsPerAttribute:2,normalize:!1,values:p}));return new Ae.Geometry({attributes:e,indices:w,boundingSphere:_e})}(o,C,b,k,P,O,s)}};var N=new Pe.Cartesian3,R=new be.Matrix3,D=new be.Quaternion;function Ne(e,a,t,n){a=xe(t,a,N),a=Pe.Cartesian3.dot(a,e);if(Ie<a||a<w){t=xe(n,t,x),a=a<w?Oe.CesiumMath.PI_OVER_TWO:-Oe.CesiumMath.PI_OVER_TWO,a=be.Quaternion.fromAxisAngle(t,a,D),a=be.Matrix3.fromQuaternion(a,R);return be.Matrix3.multiplyByVector(a,e,e),!0}return!1}var z=new Pe.Cartographic,H=new Pe.Cartesian3,oe=new Pe.Cartesian3;function Re(e,a,t,n,i){var r=Pe.Cartographic.toCartesian(a,e._ellipsoid,H),s=Pe.Cartesian3.add(r,t,oe),o=!1,l=e._ellipsoid,u=l.cartesianToCartographic(s,z);Math.abs(a.longitude-u.longitude)>Oe.CesiumMath.PI_OVER_TWO&&(o=!0,s=Pe.Cartesian3.subtract(r,t,oe),u=l.cartesianToCartographic(s,z)),u.height=0;u=e.project(u,i);return(i=Pe.Cartesian3.subtract(u,n,i)).z=0,i=Pe.Cartesian3.normalize(i,i),o&&Pe.Cartesian3.negate(i,i),i}var le=new Pe.Cartesian3,ue=new Pe.Cartesian3;function De(e,a,t,n,i,r){var s=Pe.Cartesian3.subtract(a,e,le);Pe.Cartesian3.normalize(s,s);t-=q,t=Pe.Cartesian3.multiplyByScalar(s,t,ue);Pe.Cartesian3.add(e,t,i);n-=X,t=Pe.Cartesian3.multiplyByScalar(s,n,ue);Pe.Cartesian3.add(a,t,r)}var ce=new Pe.Cartesian3;function ze(e,a){var t=r.Plane.getPointDistance(Q,e),n=r.Plane.getPointDistance(Q,a),i=ce;Oe.CesiumMath.equalsEpsilon(t,0,Oe.CesiumMath.EPSILON2)?(i=xe(a,e,i),Pe.Cartesian3.multiplyByScalar(i,Oe.CesiumMath.EPSILON2,i),Pe.Cartesian3.add(e,i,e)):Oe.CesiumMath.equalsEpsilon(n,0,Oe.CesiumMath.EPSILON2)&&(i=xe(e,a,i),Pe.Cartesian3.multiplyByScalar(i,Oe.CesiumMath.EPSILON2,i),Pe.Cartesian3.add(a,i,a))}var He=new Pe.Cartographic,Be=new Pe.Cartographic,Ge=new Pe.Cartesian3,Ve=new Pe.Cartesian3,je=new Pe.Cartesian3,Ye=new Pe.Cartesian3,Fe=new Pe.Cartesian3,qe=new Pe.Cartesian3,Xe=[He,Be],We=new Pe.Rectangle,Ue=new Pe.Cartesian3,Ze=new Pe.Cartesian3,Je=new Pe.Cartesian3,Qe=new Pe.Cartesian3,Ke=new Pe.Cartesian3,$e=new Pe.Cartesian3,ea=new Pe.Cartesian3,aa=new Pe.Cartesian3,ta=new Pe.Cartesian3,na=new Pe.Cartesian3,ia=new Pe.Cartesian3,ra=new Pe.Cartesian3,sa=new Pe.Cartesian3,oa=new Pe.Cartesian3,la=new Le.EncodedCartesian3,ua=new Le.EncodedCartesian3,ca=new Pe.Cartesian3,Ca=new Pe.Cartesian3,pa=new Pe.Cartesian3,da=[new be.BoundingSphere,new be.BoundingSphere],ha=[0,2,1,0,3,2,0,7,3,0,4,7,0,5,4,0,1,5,5,7,4,5,6,7,5,2,6,5,1,2,3,6,2,3,7,6],ga=ha.length;function fa(e){return new Ae.GeometryAttribute({componentDatatype:ke.ComponentDatatype.FLOAT,componentsPerAttribute:4,normalize:!1,values:e})}return y._projectNormal=Re,function(e,a){return Se.initialize().then(function(){return B.defined(a)&&(e=y.unpack(e,a)),y.createGeometry(e)})}});
